(()=>{"use strict";class e{constructor(e,t,o){this.elements=document.querySelectorAll(e),this.activeClass=t,this.handleActive=this.handleActive.bind(this),this.config=o||!1}handleActive(e){e.preventDefault(),this.config?e.currentTarget.classList.toggle(this.activeClass):(this.elements.forEach((e=>e.classList.remove(this.activeClass))),e.currentTarget.classList.add(this.activeClass))}addEvent(){this.elements.forEach((e=>e.addEventListener("click",this.handleActive)))}init(){return this.addEvent(),this}}class t{constructor(e,t){this.element=document.querySelector(e),this.handle=document.querySelector(t),this.handleScroll=this.handleScroll.bind(this)}handleScroll(e){e.preventDefault(),this.element.scrollIntoView({behavior:"smooth",block:"start"})}addEvent(){this.handle.addEventListener("click",this.handleScroll)}init(){return this.addEvent(),this}}const o=new e("[data-type]","on"),n=new e("[data-mobile]","on",!0),a=(new t("body","[data-scroll]"),new t("[data-pokemon]","[data-pokedex]"));new class{constructor(e,t,o,n,a,s,i){this.pokemonWrapper=document.querySelector(e),this.pokemonFilter=document.querySelectorAll(t),this.pokemonSearch=document.querySelectorAll(o),this.pokemonShow=document.querySelector(n),this.pokemonCount=document.querySelector(a),this.pokemonModal=document.querySelector(s),this.pokemonPlusType=document.querySelector(i),this.count=0}static repairName(e){const t=e,o=t.toUpperCase();return t.replace(/^\w/,o.slice(0,1))}static repairId(e){const t=e.toString();let o;return 1===t.length?o=t.replace(/(\d)/,"00$&"):2===t.length?o=t.replace(/(\d)(\d)/,"0$1$2"):t.length>=3&&(o=t),o}static repairHeight(e){const t=e.toString();let o;return t.length<=1?o=t.replace(/(\d)/,"0.$1m"):t.length<=2?o=t.replace(/(\d)(\d)/,"$1.$2m"):t.length<=3&&(o=t.replace(/(\d)(\d)(\d)/,"$1$2.$3m")),o}static repairWeight(e){const t=e.toString();let o;return t.length<=1&&0==t[0]?o=t.replace(/(\d)/,"0.$1kg"):t.length<=1&&0!=t[0]?o=t.replace(/(\d)/,"$1.0kg"):t.length<=2?o=t.replace(/(\d)(\d)/,"$1.$2kg"):t.length<=3?o=t.replace(/(\d)(\d)(\d)/,"$1$2.$3kg"):t.length<=4&&(o=t.replace(/(\d)(\d)(\d)(\d)/,"$1$2$3.$4kg")),o}async getPokemon(e){const t="number"==typeof e;t&&0===this.count?this.count+=e:t&&this.count>0&&(this.count+=1,e=this.count);const o=await fetch(`https://pokeapi.co/api/v2/pokemon/${e}`),n=await o.json();return{name:this.constructor.repairName(n.name),id:n.id,types:n.types.map((e=>({slot:e.slot,type:e.type.name}))),stats:n.stats.map((e=>({name:e.stat.name,value:e.base_stat}))),ability:n.abilities.map((e=>e.ability.name)),weight:n.weight,height:n.height,img:null!==n.sprites.other["official-artwork"].front_default?n.sprites.other["official-artwork"].front_default:"./img/png/no-image.png"}}async createPokemon(e){const t=await this.getPokemon(e),o=document.createElement("li"),n=t.types,a=this.constructor.repairWeight(t.weight),s=this.constructor.repairHeight(t.height),i=this.constructor.repairId(t.id);return o.classList.add("pokemon","initial"),o.classList.add(n[0].type),o.addEventListener("click",(({currentTarget:e})=>{this.refreshModal(t.img,t.name,i,a,s,n,t.stats,e)})),o.innerHTML=`        \n    <div data-color="${n[0].type}" class="pokemon-type"></div>\n    <div class="pokemon-info">\n      <img src="${t.img}" class="pokemon-info-img">\n      <div id="pokemon-info-heading">\n        <p class="pokemon-info-name">${t.name}</p>\n        <p class="pokemon-info-id">#${i}</p>\n      </div>\n      <p data-text="${n[0].type}" class="pokemon-info-type">\n        ${this.constructor.repairName(n[0].type)} \n        <img srcset="./img/icon/Types/icon-${n[0].type}.svg" class="pokemon-info-icon">\n      </p>  \n    </div>`,o}async insertPokemon(e,t=1){for(let o=0;o<t;o++){const t=await this.createPokemon(e);this.pokemonWrapper.appendChild(t),this.refreshCount()}}async filterPokemon(e){e.preventDefault(),this.resetPokemon();const t=e.currentTarget.dataset.type;if("all"===t)return this.insertPokemon(1,18);const o=await fetch(`https://pokeapi.co/api/v2/type/${t}`),n=await o.json(),a=await n.pokemon,s=await a.map((e=>e.pokemon.name));s.forEach((e=>this.insertPokemon(e)))}searchPokemon(e){if(e.preventDefault(),"Enter"===e.key||e.target===this.pokemonSearch[1]){const e=this.pokemonSearch[0].value.toLowerCase();this.scrollPokemon(),this.resetPokemon(),this.insertPokemon(e)}}resetPokemon(){this.count=0,document.querySelectorAll(".pokemon").forEach((e=>e.remove()))}refreshCount(){const e=document.querySelectorAll(".pokemon");this.pokemonCount.innerText=e.length}scrollPokemon(){this.pokemonWrapper.parentElement.scrollIntoView({block:"start",behavior:"smooth"})}async refreshModal(...e){this.pokemonModal.classList.add("on"),document.body.classList.add("modal-on"),e[7].classList.toggle("on"),e[7].classList.toggle("initial"),e[7].className.includes("final")&&e[7].classList.toggle("final");const t=this.pokemonModal.querySelector('[data-modal="img"]'),o=this.pokemonModal.querySelector('[data-modal="name"]'),n=this.pokemonModal.querySelector('[data-modal="id"]'),a=this.pokemonModal.querySelector('[data-modal="weight"]'),s=this.pokemonModal.querySelector('[data-modal="height"]'),i=this.pokemonModal.querySelector('[data-modal="type"]'),r=i.parentElement,l=this.pokemonModal.querySelectorAll('[data-remove="remove"]'),c=this.pokemonModal.querySelector('[data-modal="weaknesses"]'),d=this.pokemonModal.querySelectorAll('[data-modal="stats"]'),h=this.pokemonModal.querySelector('[data-modal="plusTypes"]');this.pokemonModal.style.backgroundImage=`url(./img/bg-types/${e[5][0].type}-background.svg)`,t.setAttribute("src",e[0]),o.innerText=e[1],n.innerText=`#${e[2]}`,a.innerText=e[3],s.innerText=e[4];const m=await fetch(`https://pokeapi.co/api/v2/type/${e[5][0].type}`),p=(await m.json()).damage_relations.double_damage_from.map((e=>e.name)),u=e[5].map((e=>e.type));u.length>1?r.classList.add("on"):u.length<=1&&r.classList.remove("on"),l.forEach((e=>e.remove())),u.forEach((e=>{if(0===u.indexOf(e))i.innerText=e.toUpperCase(),i.dataset.value=e;else{const t=document.createElement("li");t.innerText=e.toUpperCase(),t.dataset.value=e,t.dataset.remove="remove",h.appendChild(t)}})),p.forEach((e=>{const t=document.createElement("li");t.dataset.value=e,t.dataset.remove="remove",t.innerText=e.toUpperCase(),c.appendChild(t)})),d.forEach(((t,o)=>{let n=e[6][o].value;n=n>100?100:n,t.style.width=`${n}%`}))}bindMethods(){this.filterPokemon=this.filterPokemon.bind(this),this.searchPokemon=this.searchPokemon.bind(this)}addEvent(){this.pokemonFilter.forEach((e=>e.addEventListener("click",this.filterPokemon))),this.pokemonSearch[0].addEventListener("keyup",this.searchPokemon),this.pokemonSearch[1].addEventListener("click",this.searchPokemon),this.pokemonPlusType.addEventListener("click",(e=>{e.currentTarget.nextElementSibling.classList.toggle("on"),e.currentTarget.classList.toggle("on")})),this.pokemonShow.addEventListener("click",(()=>{this.insertPokemon(1,18)})),this.pokemonModal.querySelector("[data-exit]").addEventListener("click",(()=>{const e=document.querySelector(".pokemon.on"),t=this.pokemonModal.querySelectorAll(".on");e.classList.toggle("on"),e.classList.toggle("initial"),e.classList.toggle("final"),this.pokemonModal.classList.remove("on"),document.body.classList.remove("modal-on"),t.forEach((e=>e.classList.remove("on")))}))}init(){return this.bindMethods(),this.addEvent(),this}}("[data-pokemon]","[data-type]","[data-search]","[data-show]","[data-count]","[data-modal]",'[data-modal="plusType"]').init().insertPokemon(1,18),o.init(),n.init(),a.init()})();
